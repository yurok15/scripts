from aes.lib import unused_socket
from aes.services.autodiscovery.service import AutoDiscoveryService


class AutodiscoveryTestService(AutoDiscoveryService):
    def __init__(self, name, controller, config, loop):
        self.socket = unused_socket()
        host, port = self.socket.getsockname()
        config = {
            'host': host,
            'port': port,
            'period': 10,
            'broadcast': '255.255.255.0'
        }
        super(AutodiscoveryTestService, self).__init__(
            name, controller, config, loop)

    def close(self):
        self.socket.close()
        super(AutodiscoveryTestService, self).close()
