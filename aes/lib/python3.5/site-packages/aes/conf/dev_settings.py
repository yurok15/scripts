DOCKER_HOST = 'localhost'

DEBUG = True

ENGINES = {
    'clam_av': {
        'class': 'aes.engines.ClamAVEngine',
        'host': DOCKER_HOST,
        'port': 3310,
        'timeout': 60,
        'retry_attempts': 3,
        'limit': 10,
        'max_chunk_size': 1 * 1024 * 1024,
        'fast_plain_text': False,
        'cache_ttl': 60,
        'cache_lru': 100,
    },
    'cyren': {
        'class': 'aes.engines.CyrenEngine',
        'host': DOCKER_HOST,
        'port': 8088,
        'timeout': 60,
        'retry_attempts': 3,
        'limit': 10,
        'fast_plain_text': False,
        'spam_support': True,
        'cache_ttl': 60,
        'cache_lru': 100,
    },
    'cyren_av': {
        'class': 'aes.engines.CyrenAVEngine',
        'host': DOCKER_HOST,
        'port': 2705,
        'timeout': 60,
        'retry_attempts': 3,
        'limit': 10,
        'fast_plain_text': False,
        'cache_ttl': 60,
        'cache_lru': 100,
    },
    'sophos': {
        'class': 'aes.engines.SophosEngine',
        'host': DOCKER_HOST,
        'port': 4010,
        'timeout': 60,
        'retry_attempts': 3,
        'limit': 10,
        'fast_plain_text': False,
        'ignore_errors':
            ['020F', '0211', '0212', '021A', '021D', '0225', '0237'],
        'scan_errors':
            ['0202', '0208', '0209', '0210', '0213', '0215'],
    },
    'cloudmark': {'class': 'aes.engines.CloudmarkEngine'},
    'vade_retro': {
        'class': 'aes.engines.VadeRetroEngine',
        'host': DOCKER_HOST,
        'port': 11025,
        'timeout': 60,
        'retry_attempts': 3,
        'limit': 10,
        'cache_ttl': 60,
        'cache_lru': 100,
    },
    'mail_flow': {
        'class': 'aes.engines.MailFlowEngine',
        'source_ip_missed': [
            {
                'peer': [],
                'chain': []
            },
        ],
        'source_ip_present': [
            {
                'peer': [],
                'chain': []
            },
        ],
    }
}

DELIVERY = {
    'send': {
        'class': 'aes.delivery.StaticRouteDelivery',
        'host': '127.0.0.1',
        'port': 8087,
    },
    'admin_quarantine': {
        'class': 'aes.delivery.AdminQuarantineDelivery',
        'command_encoding': 'utf-8',
    },
    'user_quarantine': {
        'class': 'aes.delivery.UserQuarantineDelivery',
        'command_encoding': 'utf-8',
    },
    'deny': {
        'class': 'aes.delivery.StaticRouteDelivery',
        'host': '127.0.0.1',
        'port': 40425,
        'command_encoding': 'utf-8',
    },
    'ndr': {
        'class': 'aes.delivery.ndr.NDRDelivery',
        'starttls': None
    },
}

SERVICES = {
    'policy': {'class': 'tests.core.services.dev_policy.DevPolicyService'},
    'http': {
        'class': 'aes.services.HttpService',
        'host': '0.0.0.0',
        'port': 8000,
        'debug': True,
    },
    'inbound': {
        'class': 'aes.services.InboundSMTPService',
        'host': "0.0.0.0",
        'port': 1025,
        'ssl': None,
        'starttls': {
            'cert': 'src/certs/server.crt',
            'key': 'src/certs/server.key'
        },
        'helo_string': 'AESv2 Core Inbound',
        'data_size_limit': 1024 * 1024 * 100,
    },
    'outbound': {
        'class': 'aes.services.OutboundSMTPService',
        'host': "0.0.0.0",
        'port': 1026,
        'ssl': None,
        'starttls': {
            'cert': 'src/certs/server.crt',
            'key': 'src/certs/server.key'
        },
        'helo_string': 'AESv2 Core Outbound',
        'data_size_limit': 1024 * 1024 * 100,
    },
    'forks': {
        'class': 'aes.services.ForksService',
        'count': 0,
    },
    'prometheus': {'class': 'aes.services.PrometheusService'},
    'web': {'class': 'aes.services.WebService'},
    'autodiscovery': {
        'class': 'aes.services.AutoDiscoveryService',
        'host': '0.0.0.0',
        'port': 1027,
        'period': 20,
        'broadcast': '255.255.255.255',
    },
    'cluster': {
        'class': 'aes.services.ClusterService',
        'host': '0.0.0.0',
        'port': 1027,
        'name': 'default',
        'reconnect_period': 15,
        'timeout': 15,
        'cluster_hosts': None,
    },
    'config': {'class': 'aes.services.ConfigService'},
    'messages': {'class': 'aes.services.MessagesService'},
    'vade_retro': {
        'class': 'aes.services.VadeRetroFakeService'},
    'clamav': {'class': 'aes.services.ClamAVFakeService'},
    'sender': {'class': 'aes.services.EmailSenderService'},
    'elastic': {
        'class': 'aes.services.ElasticSearchService',
        'hosts': ['localhost:9200'],
        'auth': ('admin', 'pass'),
        'indexes': {
            'analytics': 'aes_events',
            'logs': 'aes_events'
        },
        'timeout': 60,
    },
    'analytics': {'class': 'aes.services.DirectLogstashService'},
}
