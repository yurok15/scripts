current_backend = None


def set_user_context(**kwargs) -> None:
    """
    Set user context params (will be passed to all logging messages)
    Works only with current event loop (logging dont known anything about
    event loops)
    """
    if current_backend is None:
        return
    current_backend.set_logging_context(kwargs)


def get_user_context() -> dict:
    """ Returns current task user context if it is available """
    if current_backend is None:
        return {}
    return current_backend.get_logging_context()


async def log_attachment(attachment):
    if not current_backend:
        return
    await current_backend.log_message('attachment', attachment.analytics)
