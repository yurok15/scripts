import inspect
from aes.services.http import json_response


class BaseApp:
    js = []
    css = []
    app_name = ''
    menu = {
        'label': 'Base',
        'url': '/',
        'sub_items': []
    }

    @json_response
    async def route(self, request, params):
        method_name = params.pop('method')
        assert not method_name.startswith('_')
        func = getattr(self, method_name)
        if inspect.iscoroutinefunction(func):
            return await func(request, **params)
        return func(request, **params)
