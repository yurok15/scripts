app.controller("VadeRetroCtrl", ['$scope', '$http',
    function ($scope, $http) {
        $scope.config = {'state': 10};
        $scope.states = [10, ""];
        $scope.enable_loading = true;
        $scope.form_loading = true;
        $scope.enabled = false;
        $scope.enable_vd = function(value){
            $scope.enable_loading = true;
            $http.get("/web_app", {"params":
                {
                    "app": "vade_retro",
                    "method": "enable",
                    "value": value
                }
            }).then(function successCallback(response) {
                $scope.enable_loading = false;
                $scope.enabled = value;
            });
        };
        $http.get("/web_app", {"params":
            {
                "app": "vade_retro",
                "method": "get_config"
            }
        }).then(function successCallback(response) {
            $scope.enable_loading = false;
            $scope.form_loading = false;
            $scope.states = response.data.states;
            $scope.config = response.data.config;
            $scope.enabled = response.data.enabled;
            $scope.host = response.data.host;
            $scope.port = response.data.port;
        });
        $scope.submit=function(){
            $scope.form_loading = true;
            $http.post("/web_app",
                angular.toJson($scope.config),
                {"params":
                    {
                        "app": "vade_retro",
                        "method": "web_configure"
                    }
                }
            ).then(function successCallback(response) {
                $scope.form_loading = false;
            });
        }
    }
]);