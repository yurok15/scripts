app.controller("ClamAVCtrl", ['$scope', '$http',
    function ($scope, $http) {
        $scope.signatures = [];
        $scope.add_signature = '';
        $scope.enable_loading = true;
        $scope.action_loading = true;
        $scope.enabled = false;
        $scope.enable_clamav = function(value){
            $scope.enable_loading = true;
            $http.get("/web_app", {"params":
                {
                    "app": "clamav",
                    "method": "enable",
                    "value": value
                }
            }).then(function successCallback(response) {
                $scope.enable_loading = false;
                $scope.enabled = value;
            });
        };
        $http.get("/web_app", {"params":
            {
                "app": "clamav",
                "method": "get_config"
            }
        }).then(function successCallback(response) {
            $scope.enable_loading = false;
            $scope.action_loading = false;
            $scope.signatures = response.data.signatures;
            $scope.enabled = response.data.enabled;
            $scope.host = response.data.host;
            $scope.port = response.data.port;
        });
        $scope.modify = function(action, value){
            $scope.action_loading = true;
            $http.get("/web_app", {"params":
                {
                    "app": "clamav",
                    "method": action,
                    "value": value
                }
            }).then(function successCallback(response) {
                $scope.action_loading = false;
                $scope.signatures = response.data.signatures;
            });
        };
    }
]);