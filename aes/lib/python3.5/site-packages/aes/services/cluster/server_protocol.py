from .base import (
    BaseClusterProtocol,
    NodeConnectionInfo,
)


class ClusterServerProtocol(BaseClusterProtocol):
    async def do_handshake(self, greeting: NodeConnectionInfo):
        self.node_name = greeting.name
        greeting.host = self.remote_host_name
        return self.cluster.node_connected(greeting, self)
